---
title: "**Boletin Epidemiologico Municipio de Pereira**"
subtitle: "Alertas Tempranas"
lang: es
header-includes:
- \usepackage{graphicx}
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyhead[L]{\slshape \rightmark}
- \fancyfoot[C]{\thepage}
- \renewcommand{\headrulewidth}{0.1pt}
- \usepackage{floatpag}
- \floatpagestyle{empty}
- \setlength{\headsep}{5mm}
- \addtolength{\headheight}{1.3cm}
- \pagestyle{fancyplain}
- \lhead{\includegraphics[height=1.0cm]{municipio2020.png}}
- \fancyhead[R]{Secretaria de Salud Pública y Seguridad Social \\ Vigilancia en Salud Pública \\ Semana 37 - 2022} 
geometry: "left=2cm,right=2cm,top=3cm,bottom=3cm"
output: bookdown::pdf_book
classoption:
  #- twocolumn # documento a dos columnas 
  #- landscape # posicion horizontal 
papersize: paper # tamaño del papel
linestretch: 1.0 # espacio
fontsize: 9pt # tamaño de la fuente 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(ggplot2)
library(RColorBrewer)
library(tidyverse)
library(rstatix)
library(googlesheets4)
library(linelist)
library(janitor)
library(gtsummary)
library(lubridate)
library(cowplot)
library(gt)
library(incidence)
library(flextable)
canalend <- read_excel("/cloud/project/Boletin_ Epi_Pereira/Datos/canalend.xlsx")
histo <- read_excel("/cloud/project/Boletin_ Epi_Pereira/Datos/histo.xlsx")
dengue2018 <- read_excel("/cloud/project/Boletin_ Epi_Pereira/Datos/dengue2018.xlsx")
histoira<-read_excel("/cloud/project/Boletin_ Epi_Pereira/Datos/histo_ira.xlsx")
ira<-read_excel("/cloud/project/Boletin_ Epi_Pereira/Datos/ira.xlsx")
evento_995<- read_excel("/cloud/project/Boletin_ Epi_Pereira/Datos/evento 995.xlsx")
evento_998 <- read_excel("/cloud/project/Boletin_ Epi_Pereira/Datos/evento 998.xlsx")
varicela <- read_excel("/cloud/project/Boletin_ Epi_Pereira/Datos/evento 831 datos basicos.xlsx")
filmarray <- read_sheet("https://docs.google.com/spreadsheets/d/1W9bwlXzatRVZKkwsaVo2i91fs_RcpSAQ77Ks99ykyRc/edit#gid=1377944694", sheet = "Muestras2022")
saveRDS(filmarray,"/cloud/project/Boletin_ Epi_Pereira/Datos/filmarray.rds")
viruela <- read_sheet("https://docs.google.com/spreadsheets/d/1KLou92VRu8r5buo6jG9DaERPpApAo1_FnN5n3SymIS0/edit#gid=966374205", sheet = "casos") %>% 
  clean_names()
saveRDS(viruela,"/cloud/project/Boletin_ Epi_Pereira/Datos/viruela.rds")
###################################################
evento_995<-evento_995 %>%
  filter(ajuste!="6") %>%
  filter(ajuste!= "D") %>%
  mutate(semana= as.numeric(semana)) %>%
  mutate(tot_ira= tot_irag+tot_irauci+tot_iraext)
# summary statistics on grouped linelist
infe<- evento_995 %>% 
  group_by(semana) %>% 
  summarise(
    casos = sum(tot_ira),
    c_hosp = sum(tot_irag),
    c_uci = sum(tot_irauci),
    c_ext = sum(tot_iraext))
write_excel_csv(infe, file = "/cloud/project/Boletin_ Epi_Pereira/Datos/ira2018.xls")
###################################################
evento_998<-evento_998 %>%
  filter(ajuste!="6") %>%
  filter(ajuste!= "D") %>%
  mutate(semana= as.numeric(semana)) %>%
  mutate(cas_conc= as.numeric(cas_conc))
diarreas<- evento_998 %>% 
  group_by(semana) %>% 
  summarise(
    casos = sum(cas_conc))
write_excel_csv(diarreas, file = "/cloud/project/Boletin_ Epi_Pereira/Datos/eda2018.xls")
###################################################
ira2018 <- read_csv("/cloud/project/Boletin_ Epi_Pereira/Datos/ira2018.xls")
eda<-read_excel("/cloud/project/Boletin_ Epi_Pereira/Datos/eda.xlsx")
eda2018<-read_csv("/cloud/project/Boletin_ Epi_Pereira/Datos/eda2018.xls")
epi1<- read.csv("/cloud/project/Boletin_ Epi_Pereira/Datos/epi1.csv") %>% 
  mutate(across(everything(), as.character))
epi2<- read.csv("/cloud/project/Boletin_ Epi_Pereira/Datos/epi2.csv") %>% 
  mutate(across(everything(), as.character))
epi3<- read.csv("/cloud/project/Boletin_ Epi_Pereira/Datos/epi3.csv") %>% 
  mutate(across(everything(), as.character))

epi3_1 <- epi3 %>% 
  filter(cod_eve=="346" | cod_eve=="100" |cod_eve=="300" | cod_eve=="365" |cod_eve=="455" |
            cod_eve=="650" | cod_eve=="670" | cod_eve=="330") %>% 
  filter(as.numeric(semana)<=37)      # SIEMPRE CAMBIAR A LA SEMANA NOTIFICADA DEL BOLETIN
epi1 <-add_row(epi1,epi3_1)
epi3_2 <- epi3 %>%
   filter(cod_eve=="110" | cod_eve=="113" | cod_eve=="591") %>% 
   filter(as.numeric(semana)<=37)       # SIEMPRE CAMBIAR A LA SEMANA NOTIFICADA DEL BOLETIN
epi2 <-add_row(epi2,epi3_2)
epi1<-epi1 %>% 
  filter(as.numeric(semana)<=37)   # SIEMPRE CAMBIAR A LA SEMANA NOTIFICADA DEL BOLETIN
epi2<-epi2 %>% 
  filter(as.numeric(semana)<=36)   # SIEMPRE CAMBIAR A LA SEMANA NOTIFICADA DEL BOLETIN
casos_sem<-table(epi1$cod_eve,epi1$semana)
casos_sem2<-table(epi2$cod_eve,epi2$semana)
casos2022 <- add_row(epi1, epi2)
saveRDS(casos2022,"/cloud/project/Boletin_ Epi_Pereira/Datos/casos2022.rds")
# /CirGarGen/
# /cont_jmestrada/
```

# Eventos Trazadores

## Infección respiratoria aguda {style="color:black"}

```{r, echo=FALSE}
infecciones <- sum(evento_995$tot_irag)+sum(evento_995$tot_irauci)+sum(evento_995$tot_iraext)
consultas<-sum(evento_995$tot_exturg)+sum(evento_995$tot_cau_h)+sum(evento_995$tot_h_uci) 
```

A semana epidemiológica `r ncol(casos_sem)` de 2022 se notificaron un total entre consultas externa/urgencias hospitalizaciones en sala y hospitalizaciones en UCI de `r format(consultas,scientific = F)` de las cuales el `r round(infecciones/consultas*100, digits = 2)`% (n= `r format(infecciones, scientific = F)`) corresponden a IRA. El canal endémico muestra el evento para la semana `r ncol(casos_sem)` se ubica por encima del umbral estacional, sobre el limite superior esperado.

```{r, echo=FALSE, fig.cap="Canal endémico IRA , Pereira 2022", fig.height=3, fig.width=7, fig.pos='h'}
plot(ira$semana, ira$exito, type='l', ylim=c(1,4200), xlim=c(1,52), col="green",lwd=3, xlab="Semana epidemiológica", ylab="Casos", cex=0.6)
lines(ira$alerta, col="red",lwd=3, cex=0.7)
lines(ira2018$casos, col="black", lwd=3, cex=0.7, type = "p")
abline(1300,0,1300, col="yellow", lwd=3)
legend(25,3200, c("IC Inf 95%","IC Sup 95%", "Umbral estacional", "casos 2022"), col=c("green","red","yellow","black"), lty = c(1,1), lwd = c(2,2), bty="n", cex=0.6)
```

En relación a la notificación segun servicio y comparando la semana notificada del actual año con la misma semana del año anterior, se identifica una disminución en la hospitalización IRA en UCI, pero con aumento relativo para hospitalización en sala general de $31.5\%$ y consulta externa ($29.5 \%$) y disminucion en hospitalización en UCI $-77.\%$.

**Tabla 1. Comportamiento de la Infección Respiratoria Aguda segun tipo de servicio, semana epidemiológica `r ncol(casos_sem)`**

| **Servicio**               |                 **a Sem `r ncol(casos_sem)`/2021**                  |                 **a Sem `r ncol(casos_sem)`/2022**                 |                                                                      **Variacion (%)**                                                                      |
|-----------------|:---------------:|:---------------:|:-------------------:|
| Hospitalización Sala       |           `r sum(histoira[1:ncol(casos_sem),"ira_hosp"])`           | `r format(sum(ira2018[1:ncol(casos_sem),"c_hosp"]), scientific=F)` | `r round((sum(ira2018[1:ncol(casos_sem),"c_hosp"])- sum(histoira[1:ncol(casos_sem),"ira_hosp"]))/sum(histoira[1:ncol(casos_sem),"ira_hosp"])*100,digits=1)` |
| Hospitalizacion UCI        |           `r sum(histoira[1:ncol(casos_sem),"ira_uci"])`            |            `r sum(ira2018[1:ncol(casos_sem),"c_uci"])`             |  `r round((sum(ira2018[1:ncol(casos_sem),"c_uci"])- sum(histoira[1:ncol(casos_sem),"ira_uci"]))/sum(histoira[1:ncol(casos_sem),"ira_uci"])*100,digits=1)`   |
| Consulta Externa-Urgencias | `r format(sum(histoira[1:ncol(casos_sem),"ira_ext"]),scientific=F)` | `r format(sum(ira2018[1:ncol(casos_sem),"c_ext"]), scientific=F)`  |  `r round((sum(ira2018[1:ncol(casos_sem),"c_ext"])- sum(histoira[1:ncol(casos_sem),"ira_ext"]))/sum(histoira[1:ncol(casos_sem),"ira_ext"])*100,digits=1)`   |

Para la semana `r ncol(casos_sem)` la hospitalización por IRA en sala general muestra un comportamiento para la ultima semana de aumento (Figura 2) ubicandose  por encima del limite superior esperado. Con una proporción acumulada de hospitalizacion por IRA de `r round(sum(evento_995$tot_irag)/sum(evento_995$tot_cau_h)*100,digits=2)`%.

```{r, echo=FALSE, fig.cap="Canal endémico Hospitalizaciones por IRA en sala general , Pereira 2022", fig.height=3, fig.width=7}
plot(ira$semana, ira$icinfhosp, type='l', ylim=c(1,100), xlim=c(1,52), col="green",lwd=3, xlab="Semana epidemiológica", ylab="Casos", cex=0.6, main = "")
lines(ira$icsuphosp, col="red",lwd=3, cex=0.7)
abline(44,0,44, col="yellow", lwd=3)
lines(ira2018$c_hosp, col="black", lwd=3, cex=0.7, type = "p")
legend(25,2750, c("IC Inf 95%","IC Sup 95%", "Umbral estacional", "casos 2022"), col=c("green","red","yellow","black"), lty = c(1,1), lwd = c(2,2), bty="n", cex=0.6)
```

De igual manera en el canal endémico para la notificación por IRA hospitalizados en Unidad de Cuidados Intensivos (UCI) (figura 3), muestra una disminución puntual en las hospitalizaciones en UCI por IRA. La proporción acumulada de hospitalizaciones por IRA en UCI alcanza un `r round(sum(evento_995$tot_irauci)/sum(evento_995$tot_h_uci)*100,digits=2)`%.

```{r, echo=FALSE, warning=FALSE}
uci_tot <- evento_995  %>% 
  filter(semana==ncol(casos_sem)) %>% 
  summarise(menor1 = sum(totuci_1),
            de1 = sum(totuci_2),
            d2a4 = sum(totuci_3),
            d5a19 = sum(totuci_4),
            d20a39 = sum(totuci_5),
            d40a59 = sum(totuci_6),
            mayor60 = sum(totuci_7)) %>% 
  pivot_longer(cols = 1:7, names_to = "edad1", values_to = "uci_tot")

evento_995  %>% 
  filter(semana==ncol(casos_sem)) %>% 
  summarise(`< 1`= sum(irauci_1),
            `1` = sum(irauci_2),
            `2 a 4` = sum(irauci_3),
            `5 a 19` = sum(irauci_4),
            `20 a 39` = sum(irauci_5),
            `40 a 59` = sum(irauci_6),
            `mayor e igual 60` = sum(irauci_7)) %>% 
  pivot_longer(cols = 1:7, names_to = "edad", values_to = "uci_ira") %>% 
  add_column(uci_tot[,2]) %>% 
  mutate(porcentaje = round(uci_ira/uci_tot*100,digits=1)) %>% 
  flextable::flextable() %>% 
  flextable::autofit() %>% 
  flextable::set_header_labels(
      edad = "Edad (años)", 
      uci_ira = "Hosp. UCI IRA",                  
      uci_tot = "Hosp. UCI todas las causas",
      porcentaje = "% de Hosp. UCI") %>% 
  flextable::bg(j = 4, i = ~ porcentaje>= 15, part = "body", bg = "orange") 
```

\newpage

```{r, echo=FALSE, fig.cap="Canal endémico Hospitalizaciones por IRA en UCI , Pereira 2022", fig.height=3, fig.width=7}
plot(ira$semana, ira$icinfuci, type='l', ylim=c(1,25), xlim=c(1,52), col="green",lwd=3, xlab="Semana epidemiológica", ylab="Casos", cex=0.6, main = "")
lines(ira$icsupuci, col="red",lwd=3, cex=0.7)
abline(4,0,4, col="yellow", lwd=3)
lines(ira2018$c_uci, col="black", lwd=3, cex=0.7, type = "p")
legend(8,25, c("IC Inf 95%","IC Sup 95%", "Umbral estacional", "2022"), col=c("green","red","yellow","black"), lty = c(1,1), lwd = c(2,2), bty="n", cex=0.5)
```

Por grupo de edad en la hospitalizaciones por IRA, la mayor concentración de hospitalizaciones a causa infección respiratoria se da en los menores e iguales de 4 años. Ocupando el 21,7% especificamente en los menores de 1 año, 28.6% para los de 2 a 4 años edad.

```{r,echo=FALSE, warning=FALSE}
hosp_tot <- evento_995  %>% 
  filter(semana==ncol(casos_sem)) %>% 
  summarise(menor1 = sum(hospital_1),
            de1 = sum(hospital_2),
            d2a4 = sum(hospital_3),
            d5a19 = sum(hospital_4),
            d20a39 = sum(hospital_5),
            d40a59 = sum(hospital_6),
            mayor60 = sum(hospital_7)) %>% 
  pivot_longer(cols = 1:7, names_to = "edad1", values_to = "hosp_tot")

evento_995  %>% 
  filter(semana==ncol(casos_sem)) %>% 
  summarise(`< 1`= sum(grupoh_1),
            `1` = sum(grupoh_2),
            `2 a 4` = sum(grupoh_3),
            `5 a 19` = sum(grupoh_4),
            `20 a 39` = sum(grupoh_5),
            `40 a 59` = sum(grupoh_6),
            `mayor e igual 60` = sum(grupoh_7)) %>% 
  pivot_longer(cols = 1:7, names_to = "edad", values_to = "hosp_ira") %>% 
  add_column(hosp_tot[,2]) %>% 
  mutate(porcentaje = round(hosp_ira/hosp_tot*100,digits=1)) %>% 
  flextable::flextable() %>% 
  flextable::autofit() %>% 
  flextable::set_header_labels(
      edad = "Edad (años)", 
      hosp_ira = "Hospitalizaciones IRA",                  
      hosp_tot = "Hospitalizacion todas las causa",
      porcentaje = "% de hospitalizaciones") %>% 
  flextable::bg(j = 4, i = ~ porcentaje>= 10, part = "body", bg = "yellow") 
```


En consulta externa y urgencias se han reportado de manera acumulada `r format(sum(evento_995$tot_exturg), scientific = F)` de consultas, donde las consultas por infección respiratoria aguda ocupan el `r round(sum(evento_995$iraext)/sum(evento_995$tot_exturg)*100,digits=3)`%. 

```{r, echo=FALSE, fig.cap="Canal endémico consulta externa y urgencias por IRA, Pereira 2022", fig.height=3, fig.width=7}
plot(ira$semana, ira$icinfext, type='l', ylim=c(1,3700), xlim=c(1,52), col="green",lwd=3, xlab="Semana epidemiológica", ylab="Casos", cex=0.6, main = "")
lines(ira$icsupext, col="red",lwd=3, cex=0.7)
abline(1504,0,1504, col="yellow", lwd=3)
lines(ira2018$c_ext, col="black", lwd=3, cex=0.7, type = "p")
legend(25,3800, c("IC Inf 95%","IC Sup 95%", "Umbral estacional", "2022"), col=c("green","red","yellow","black"), lty = c(1,1), lwd = c(2,2), bty="n", cex=0.6)
```

\newpage

En cuanto a la edad, en la consultas por IRA en servicio de consulta externa y urgencias, la proporción de consultas por IRA en cada grupo de edad se observa una concentración del mas de 15% en los menores de 4 años, situación comun para este grupo edad.

El canal endemico general para IRA sobre un umbral estacional, con incremento en hospitalización en sala general por IRA.

```{r, echo=FALSE, warning=FALSE}
con_tot <- evento_995  %>% 
  filter(semana==ncol(casos_sem)) %>% 
  summarise(menor1 = sum(totcext_1),
            de1 = sum(totcext_2),
            d2a4 = sum(totcext_3),
            d5a19 = sum(totcext_4),
            d20a39 = sum(totcext_5),
            d40a59 = sum(totcext_6),
            mayor60 = sum(totcext_7)) %>% 
  pivot_longer(cols = 1:7, names_to = "edad1", values_to = "consultas_tot")

evento_995  %>% 
  filter(semana==ncol(casos_sem)) %>% 
  summarise(`< 1`= sum(iracext_1),
            `1` = sum(iracext_2),
            `2 a 4` = sum(iracext_3),
            `5 a 19` = sum(iracext_4),
            `20 a 39` = sum(iracext_5),
            `40 a 59` = sum(iracext_6),
            `mayor e igual 60` = sum(iracext_7)) %>% 
  pivot_longer(cols = 1:7, names_to = "edad", values_to = "consultas_ira") %>% 
  add_column(con_tot[,2]) %>% 
  mutate(porcentaje = round(consultas_ira/consultas_tot*100,digits=1)) %>% 
  flextable::flextable() %>% 
  flextable::autofit() %>% 
  flextable::set_header_labels(
      edad = "Edad (años)", 
      consultas_ira = "Consultas IRA",                  
      consultas_tot = "Consulta todas las causa",
      porcentaje = "% de Consultas") %>% 
  flextable::bg(j = 4, i = ~ porcentaje>= 15, part = "body", bg = "red") 
```

## Circulación virus respiratorios

```{r, echo=FALSE, warning=FALSE}
filmarray <- filmarray %>% 
  mutate(fec_muestra = guess_dates(FECHA, modern_excel = TRUE))
filmarray <- filmarray %>% 
  mutate(resultado = case_when(RESULTADO == "NONE"~"Negativo",
                               RESULTADO != "NONE"~"Positivo")) %>% 
  mutate(semana = epiweek(fec_muestra))
aislamientos <- filmarray %>% 
  filter(RESULTADO != "NONE") %>% 
  separate(col = RESULTADO, into = c("m1","m2","m3","m4","m5","m6"), sep = ",")
aislamiento <- aislamientos %>% pivot_longer(cols = starts_with("m"), names_to = "microorganismo") %>% 
  filter(!is.na(value)) %>%
  mutate(value = str_squish(value))

positivo <- filmarray %>% 
  group_by(resultado) %>% 
  summarise(n=n()) %>% 
  adorn_percentages(denominator = "col") %>% 
  adorn_pct_formatting()

microorg <- aislamiento %>% 
  group_by(value) %>% 
  summarise(n = n()) %>% 
  mutate(prop = round(n/sum(n)*100,digits = 1)) %>% 
  arrange(desc(n))

```

```{r, echo=FALSE, warning=FALSE, fig.height=2 , fig.width=7, fig.cap="Positividad muestras tracto respiratorio, Pereira 2022"}
filmarray %>% 
  group_by(semana) %>% 
  tabyl(semana, resultado) %>% 
  adorn_percentages() %>% 
  pivot_longer(cols = c("Negativo","Positivo"), names_to = "resultado") %>% 
  ggplot(aes(x = semana, y = value, fill = resultado))+ geom_col(color="black")+
  scale_x_continuous(limits = c(0,35), breaks = seq(1,35,1))+
  labs(x = "Semana epidemiologica",
       y = "Proporción")+ theme_minimal()
```
\newpage
Como coadyuvante a la estrategia de vigilancia de la infección respiratoria aguda se recolectan resultados de pruebas realizadas para el diagnostico etiologico viral en las diferentes instituciones de salud con capacidad diagnostica, principalmente a traves de paneles respiratorios virales de tecnologia filmarray. 
Para el periodo epidemiologico actual se han procesado `r nrow(filmarray) ` muestras en el municipio, con aislameintos tanto virales como bacterianos con una positividad acumulada de `r positivo[2,2] `  y una  positividad semanal como lo muestra la **figura 5**.

La circulación viral es multiple para virus comunmente conocidos como etiologia viral de la infección respiratoria aguda, pricipalmente se observa en circulación en una mayor proporción  Rhinovirus con un `r microorg[microorg$value=="Rhinovirus",3]`% de los aislamientos (n= `r  microorg[microorg$value=="Rhinovirus",2]`), seguido por Enterovirus con `r microorg[microorg$value=="Enterovirus",3]`% (n= `r  microorg[microorg$value=="Enterovirus",2]`) y Adenovirus `r microorg[microorg$value=="Adenovirus",3]`% (n= `r  microorg[microorg$value=="Adenovirus",2]`) (**Figura 6**). Aislamientos de inlfuenza surgen en las ultimas tres semanas epidemiologicas, lo que podria tener una responsabilidad importante en el incrmento en la hospitalizacion en IRA en sala general, especialmente en menores de 4 años.


Su comportamiento temporal (semana epidemiologica), predominan el Rhinovirus y Virus Sincitial Respiratorio (VSR). Se dientifica una aumento en las ultimas semanas en aislamientos respiratorios por paneles virales para VSR y adicionalmente los que ya venian relacionados a Rhinovirus.

Se debe intrepretar con cautaela los resultados mostrados en cuanto a circulación viral del municipio, pues es obtenida de muestras en pacientes consultantes a servicios de urgencias y no como parte de la vigilancia centinela de virus respiratorios del Instituto Nacional de Salud (bajo muestreo sistematico en servicios ambulatoirios), ya que en el departamento (municipio de Pereira) no hay UPGD centinelas para esta estrategia.

```{r, echo=FALSE, warning=FALSE, fig.height=3.2 , fig.width=7, fig.cap="Positividad muestras tracto respiratorio, Pereira 2022"}
aislamiento %>% 
  mutate(viral = case_when(value == "Enterovirus" ~ "Enterovirus",
                                         value == "Rhinovirus"~ "Rhinovirus",
                                         value == "Rinovirus"~ "Rhinovirus",
                                         value == "metaneumovirus" ~ "metaneumovirus",
                                         value == "Metaneumovirus" ~ "metaneumovirus",
                                         value == "Metapneumovirus" ~ "metaneumovirus",
                                         value == "Adenovirus" ~ "Adenovirus",
                                         value == "Influenza A" ~ "Influenza A",
                                         value == "Respiratory Syncytial Virus"~ "VSR",
                                         value == "Virus Sincitial Respiratorio"~ "VSR",
                                         value == "SARS-CoV-2"~"SARS-CoV-2",
                                         value == "Parainfluenza Virus" | value == "Parainfluenza Virus 1" | value == "Parainfluenza Virus 2" | value == "Parainfluenza Virus 3" | value == "Parainfluenza Virus 4"| value == "Parainfluenza Virus" ~ "Parainfluenza Virus (1,2,3)")) %>%
  replace_na(list(viral = "Otras")) %>% 
  group_by(semana, viral) %>% summarise(Aislamientos = n(), .groups = "keep") %>% 
  ggplot(aes(x = semana, y = Aislamientos,
             fill = factor(viral, levels = c("Otras","Adenovirus","Enterovirus","Rhinovirus", "VSR","Influenza A","metaneumovirus","SARS-CoV-2","Parainfluenza Virus (1,2,3)"))))+
           geom_col()+
           scale_x_continuous(limits = c(0,35), breaks = seq(1,35,1))+
           labs(x = "Semana epidemiologica", y = "n Aislamientos")+ theme_minimal()+
    theme(legend.title = element_blank(), legend.position = "bottom")+
  scale_fill_brewer(palette= "Set1")
```

## Enfermedades transmitidas por vectores

Para las diferentes enfermedades transmitidas por vectores el reporte de casos para esta semana y su acumulado se presentan en la siguiente tabla:
\newpage
```{r, echo=FALSE, fig.height=3, fig.width=7, fig.cap="Canal endémico Dengue, Pereira 2022"}
plot(canalend$semana, canalend$exito, type='l', ylim=c(0,50), xlim=c(1,52), col="green",lwd=2, xlab="Semana epidemiológica", ylab="Casos", cex=0.6, main = "")
lines(canalend$alerta, col="red",lwd=2, cex=0.7)
lines(canalend$media, col="yellow",lwd=2, cex=0.7)
lines(casos_sem2['210',], col="black",lwd=2, cex=0.7)
legend(10,50, c("IC inf 95%","Media", "IC sup 95%", "2022"), col=c("green","yellow","red","black"), lty = c(1,1), lwd = c(1,1), bty="n", cex=0.7)
```

**Tabla 2. Comportamiento de la enfermedades transmitidas por vectores, semana epidemiológica `r ncol(casos_sem)`**

| **Evento**  |           **Semana actual**            |                  **Acumulado**                   |
|----------------------|:------------------------:|:----------------------:|
| Dengue      | `r casos_sem2["210",ncol(casos_sem2)]` | `r sum(casos_sem2[c("210"),1:ncol(casos_sem2)])` |
| Chinkunguya |                   0                    |                        0                         |
| Zika        |                   0                    |                        0                         |
| Malaria     | `r casos_sem2["465",ncol(casos_sem2)]` | `r sum(casos_sem2[c("465"),1:ncol(casos_sem2)])` |

según canal endémico (figura 5) se identifica dengue con un comportamiento por debajo del intervalo inferior, en zona de seguridad.

## Infección Diarreica Aguda

```{r, echo=FALSE, fig.height=3, fig.width=7}
plot(eda$semana, eda$exito, type='l', ylim=c(0,1500), xlim=c(1,52), col="green",lwd=2, xlab="Semana epidemiológica", ylab="Casos", cex=0.7, main = "")
lines(eda$alerta, col="red",lwd=2, cex=0.7)
abline(683,0,683, col="yellow", lwd=3)
lines(eda2018$semana,eda2018$casos, col="black",lwd=2, cex=0.7)
legend(25,1400, c("IC inf 95%","Media", "IC sup 95%", "2022"), col=c("green","yellow","red","black"), lty = c(1,1), lwd = c(1,1), bty="n", cex=0.5)
```

\newpage

# Eventos de interes en salud pública

## Mortalidad materno-perinatal

En la semana epidemiológica `r ncol(casos_sem)` de 2022 se notificaron `r casos_sem["560",ncol(casos_sem)]` muertes perinatales; `r sum(casos_sem["560",1:ncol(casos_sem)])` casos acumulados hasta el momento.

**Tabla 3. Comparación historica de eventos de baja incidencia , semana epidemiológica `r ncol(casos_sem)`**

| **Evento**          |             **Observado**              |                         **Esperado**                         |                                              **Valor p**                                              |
|--------------------|:---------------:|:---------------:|:---------------:|
| Int. suicida        | `r casos_sem["356",ncol(casos_sem2)]`  | `r round(as.numeric(histo[11,ncol(casos_sem)+1]),digits=0)`  | `r round(dpois(casos_sem["356",ncol(casos_sem)], as.numeric(histo[11,ncol(casos_sem)+1])), digits=2)` |
| ETA                 |  `r casos_sem["355",ncol(casos_sem)]`  | `r round(as.numeric(histo[6,ncol(casos_sem)+1]), digits=0)`  |  `r round(dpois(casos_sem["355",ncol(casos_sem)], as.numeric(histo[6,ncol(casos_sem)+1])),digits=2)`  |
| Hepatitis A         |                   0                    | `r round(as.numeric(histo[8,ncol(casos_sem2)+1]),digits=0)`  |                 `r round(dpois(0, as.numeric(histo[8,ncol(casos_sem2)+1])),digits=2)`                 |
| Lepra               |                   0                    | `r round(as.numeric(histo[12,ncol(casos_sem2)+1]),digits=0)` |                `r round(dpois(0, as.numeric(histo[12,ncol(casos_sem2)+1])),digits=2)`                 |
| Leptospirosis       |  `r casos_sem["455",ncol(casos_sem)]`  | `r round(as.numeric(histo[13,ncol(casos_sem)+1]),digits=0)`  | `r round(dpois(casos_sem["455",ncol(casos_sem)], as.numeric(histo[13,ncol(casos_sem)+1])),digits=2)`  |
| Malaria             | `r casos_sem2["465",ncol(casos_sem2)]` | `r round(as.numeric(histo[14,ncol(casos_sem2)+1]),digits=0)` |                `r round(dpois(0, as.numeric(histo[14,ncol(casos_sem)+1])), digits=2)`                 |
| Sarampion           |                   0                    | `r round(as.numeric(histo[22,ncol(casos_sem)+1]), digits=0)` |                `r round(dpois(0, as.numeric(histo[22,ncol(casos_sem)+1])), digits=2)`                 |
| Tosferina           |                   0                    |                              0                               |                                                   0                                                   |
| Sifilis gestacional |  `r casos_sem["750",ncol(casos_sem)]`  | `r round(as.numeric(histo[24,ncol(casos_sem)+1]), digits=0)` | `r round(dpois(casos_sem["750",ncol(casos_sem)], as.numeric(histo[24,ncol(casos_sem)+1])), digits=2)` |
| Sifilis congénita   |                   0                    | `r round(as.numeric(histo[23,ncol(casos_sem)+1]), digits=0)` |                `r round(dpois(0, as.numeric(histo[23,ncol(casos_sem)+1])), digits=2)`                 |

## Agresiones por animales potencialmente transmisores de rabia

En la semana epidemiológica `r ncol(casos_sem)` de 2022 se notificaron al Sivigila `r casos_sem["300",ncol(casos_sem)]` casos de agresiones por animales potencialmente transmisores de rabia , con un acumulado hasta el momento de `r sum(casos_sem["300",1:ncol(casos_sem)])` casos.

## Tuberculosis

Se notificaron al sistema de vigilancia para esta semana `r casos_sem2["813",ncol(casos_sem2)]` casos de tuberculosis sensible, con un acumulado en el sivigila de `r sum(casos_sem2["813",1:ncol(casos_sem2)])` casos para TB sensible.

## VIH/SIDA

Se han notificado `r casos_sem2["850",ncol(casos_sem2)]` casos de VIH/SIDA, con un acumulado en el sivigila de `r sum(casos_sem2["850",1:ncol(casos_sem2)])` casos.

## Sìfilis gestacional y congénita

Para esta semana se notificaron al Sivigila `r casos_sem["750", ncol(casos_sem)]` casos de sìfilis gestacional, y casos de sìfilis congénita hasta el momento se han notificado `r casos_sem["740", ncol(casos_sem)]` casos.

## Cáncer

Entre los tipos de cáncer objeto de vigilancia en salud pública se encuentra cáncer de mama y cuello uterino. De este evento esta semana se notificaron `r casos_sem["155", ncol(casos_sem)]` casos (figura 1), con un acumulado hasta el momento de `r sum(casos_sem["155",1:ncol(casos_sem)])`. En Cáncer en menor de 18 años se han reportado a la fecha `r sum(casos_sem["115",1:ncol(casos_sem)])` casos.

## Defectos congénitos y bajo peso al nacer

Para esta semana epidemiológica `r ncol(casos_sem)` de 2022 se notificaron al sistema de vigilancia `r casos_sem["215", ncol(casos_sem)]` casos de defecto congénito, y `r casos_sem2["110", ncol(casos_sem2)]` casos de bajo peso al nacer, siendo este último catalogado como de alta incidencia. El total de casos ingresados hasta el momento son: `r sum(casos_sem["215",1:ncol(casos_sem)])` casos para defectos congénitos y `r sum(casos_sem2["110",1:ncol(casos_sem2)])` casos para bajo peso al nacer.

## Inmunoprevenibles

Frente al evento varicela, para esta semana epidemiológica se notificaron `r casos_sem["831", ncol(casos_sem)]` casos, con un acumulado de hasta el momento de `r sum(casos_sem["831",1:ncol(casos_sem)])`.

## Virus nuevo (COVID-19)

```{r,echo=FALSE, warning=FALSE}
covid <- epi1 %>% group_by(ajuste_) %>% count()
```

Para este evento desde el año 2020 que inicio la pandemia se han registrado 69788 casos confirmados para el municipio de Pereira, significando esto alrededor de mas de 1500 muertes por esta causa relacionadas. Durante este año 2022, se han notificado a semana epidemiologica `r ncol(casos_sem)` al sistema de vigilancia SIVIGILA un total de `r sum(casos_sem["346",1:ncol(casos_sem)])` casos entre probables y confirmados. con una proporcion de confirmación de `r round(covid[covid$ajuste_=="3","n"]/sum(covid[,"n"])*100, digits=2)`%, permaneciendo como probables `r round(covid[covid$ajuste_=="0","n"]/sum(covid[,"n"])*100, digits=2)`%.

```{r, echo=FALSE, warning=FALSE, fig.height=3 , fig.width=7, fig.cap="Notificacion semanal COVID-19, Pereira 2022"}
ggplot(epi1 %>% filter(cod_eve=="346" & ajuste_!="7"))+
  geom_bar(aes(x=as.numeric(semana), fill=ajuste_), position = "dodge")+ theme_bw()+
  xlab("Semana/epidemiologica")+
  ylab("Casos notificados")+
  coord_cartesian(xlim = c(1,26))+
  labs(fill = "Tipo de caso")+
  scale_fill_hue(labels = c("Probable", "Confirmado Lab", "Nexo Epidemiologico"))

```

Como se observa en la grafica la notificación presenta dismunución en numero de casos segun avanza el año epidemiologico en seguimiento, algunas razones para esto es la disminución de la transmisión producto de una superación de un cuarto pico epidemico por el que el pais acaba de pasar. Otra de las razones posibles en la disminucion es el cambio lineamientos en el uso de pruebas diagnosticas para infección por SARS-Cov-2, implicando lo anterior un cambio el deteccion de la enfermedad para la vigilancia.

# Vigilancia intensificada de exantematicas

## Vigilancia Viruela

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.cap="Comportamiento de varicela para Hombres por grupos de edad, Pereira 2022"}
####################################################################################################
varicela <- varicela %>% mutate(gr_edad = case_when(uni_med_>=2 ~ "0-9",
                                             uni_med_ == 1 & edad_< 10 ~ "0-9",
                                             uni_med_ == 1 & edad_>=10 & edad_<20 ~ "10 a 19",
                                             uni_med_ == 1 & edad_>=20 & edad_<=40 ~ "20 a 40",
                                             uni_med_ == 1 & edad_>40 ~ "Mayores a 40")) %>%
  group_by(semana, sexo_, gr_edad) %>% count(semana, name = "casos") %>% 
  mutate(semana = as.numeric(semana))

varicela_ajus <- expand.grid(semana = 1:37, sexo_=c("F","M"), gr_edad=c("0-9","10 a 19","20 a 40","Mayores a 40"))

varicela_ajus <- varicela_ajus %>% left_join(varicela, by=c("semana","sexo_","gr_edad")) %>%
  replace_na(list(casos = 0))

## 0 a 9 años 
#
m1 <- ggplot(varicela_ajus %>% 
         filter(sexo_=="M" & gr_edad=="0-9"), aes(x = as.numeric(semana), y = casos))+
  geom_abline(intercept = 1, slope = 0, color = "green", size = 1)+
  geom_abline(intercept = 7, slope = 0, color = "red", size = 1)+
  geom_abline(intercept = 2, slope = 0, color = "yellow", size = 1)+
  geom_point(size = 1)+
  coord_cartesian(xlim = c(1,52), y = c(0,10))+
  labs(x= "Semana epidemiologica", y = "Casos", title = " Hombres", subtitle = "0 a 9 años")+
  theme_linedraw()

## 10 a 19 años 
m2 <- ggplot(varicela_ajus %>% 
         filter(sexo_=="M" & gr_edad=="10 a 19"), aes(x = as.numeric(semana), y = casos))+
  geom_abline(intercept = 1, slope = 0, color = "green", size = 1)+
  geom_abline(intercept = 5, slope = 0, color = "red", size = 1)+
  geom_abline(intercept = 2, slope = 0, color = "yellow", size = 1)+
  geom_point(size = 1)+
  coord_cartesian(xlim = c(1,52), y = c(0,10))+
  labs(x= "Semana epidemiologica", y = "Casos", title = "10 a 19 años")+
  theme_linedraw()

# de 20 a 40 años
m3 <- ggplot(varicela_ajus %>% 
         filter(sexo_=="M" & gr_edad=="20 a 40"), aes(x = semana, y = casos))+
  geom_abline(intercept = 1, slope = 0, color = "green", size = 1)+
  geom_abline(intercept = 7, slope = 0, color = "red", size = 1)+
  geom_abline(intercept = 2, slope = 0, color = "yellow", size = 1)+
  geom_point(size = 1)+
  coord_cartesian(xlim = c(1,52), y = c(0,10))+
  labs(x= "Semana epidemiologica", y = "Casos", title = "20 a 40 años")+
  theme_linedraw()

## mayores a 40 años 
m4 <- ggplot(varicela_ajus %>% 
         filter(sexo_=="M" & gr_edad=="Mayores a 40"), aes(x = semana, y = casos))+
  geom_abline(intercept = 1, slope = 0, color = "green", size = 1)+
  geom_abline(intercept = 6, slope = 0, color = "red", size = 1)+
  geom_abline(intercept = 2, slope = 0, color = "yellow", size = 1)+
  geom_point(size = 1)+
  coord_cartesian(xlim = c(1,52), y = c(0,10))+
  labs(x= "Semana epidemiologica", y = "Casos", title = "40 y mas años")+
  theme_linedraw()

plot_grid(m1,m2,m3,m4)
```

Ante la emergencia en salud publica internacional declarada por OMS por brote multi-pais por viruela simica, se inicia vigilancia de comportamientos inusuales para varicela en diferentes grupos de edad y sexo, en este sentido para semana epidemiologica  `r ncol(casos_sem)` no se presentan comportamientos fuera de lo esperado para ningun grupo de edad o sexo.

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.cap="Comportamiento de varicela para Mujeres por grupos de edad, Pereira 2022"}
m11 <- ggplot(varicela_ajus %>% 
         filter(sexo_=="F" & gr_edad=="0-9"), aes(x = as.numeric(semana), y = casos))+
  geom_abline(intercept = 1, slope = 0, color = "green", size = 1)+
  geom_abline(intercept = 7, slope = 0, color = "red", size = 1)+
  geom_abline(intercept = 2, slope = 0, color = "yellow", size = 1)+
  geom_point(size = 1)+
  coord_cartesian(xlim = c(1,52), y = c(0,10))+
  labs(x= "Semana epidemiologica", y = "Casos", title = "Mujeres", subtitle = "0 a 9 años")+
  theme_linedraw()

## 10 a 19 años 
m22 <- ggplot(varicela_ajus %>% 
         filter(sexo_=="F" & gr_edad=="10 a 19"), aes(x = as.numeric(semana), y = casos))+
  geom_abline(intercept = 1, slope = 0, color = "green", size = 1)+
  geom_abline(intercept = 5, slope = 0, color = "red", size = 1)+
  geom_abline(intercept = 2, slope = 0, color = "yellow", size = 1)+
  geom_point(size = 1)+
  coord_cartesian(xlim = c(1,52), y = c(0,10))+
  labs(x= "Semana epidemiologica", y = "Casos", title = "10 a 19 años")+
  theme_linedraw()

# de 20 a 40 años
m33 <- ggplot(varicela_ajus %>% 
         filter(sexo_=="F" & gr_edad=="20 a 40"), aes(x = as.numeric(semana), y = casos))+
  geom_abline(intercept = 1, slope = 0, color = "green", size = 1)+
  geom_abline(intercept = 7, slope = 0, color = "red", size = 1)+
  geom_abline(intercept = 2, slope = 0, color = "yellow", size = 1)+
  geom_point(size = 1)+
  coord_cartesian(xlim = c(1,52), y = c(0,10))+
  labs(x= "Semana epidemiologica", y = "Casos", title = "20 a 40 años")+
  theme_linedraw()

## mayores a 40 años 
m44 <- ggplot(varicela_ajus %>% 
         filter(sexo_=="F" & gr_edad=="Mayores a 40"), aes(x = as.numeric(semana), y = casos))+
  geom_abline(intercept = 1, slope = 0, color = "green", size = 1)+
  geom_abline(intercept = 6, slope = 0, color = "red", size = 1)+
  geom_abline(intercept = 2, slope = 0, color = "yellow", size = 1)+
  geom_point(size = 1)+
  coord_cartesian(xlim = c(1,52), y = c(0,10))+
  labs(x= "Semana epidemiologica", y = "Casos", title = "40 y mas años")+
  theme_linedraw()

plot_grid(m11,m22,m33,m44)
```



## Brote multi-pais Viruela Simica (Pereira)

A semana epidemiologica `r ncol(casos_sem)` se han reportado `r nrow(viruela) `  alertas al sistema de vigilancia que corresponden a casos probables de los cuales se tiene confirmación en cinco casos (n= `r table(viruela$clasificacion_final_del_caso)[2] `),  (n= `r table(viruela$clasificacion_final_del_caso)[1]`) descartado y `r table(viruela$clasificacion_final_del_caso)[3]` pendiente de resultado. Algunas de los caracteristicas demograficas de casos probables y confirmados se muestran acontinuación:

```{r, echo=FALSE, warning=FALSE, message=FALSE}
viruela %>% select(caso, edad, sexo, clasificacion_final_del_caso) %>% 
  filter(clasificacion_final_del_caso=="POSITIVO") %>% 
  #gt() %>% cols_label(caso = "Caso", edad = "Edad", sexo = "Sexo", clasificacion_final_del_caso = "Clasificación") %>% 
  #tab_header(title = "Caracteristicas demograficas de casos notificados, Pereira 2022") %>% 
  flextable() %>% 
  flextable::bg(j = 4, i = ~ clasificacion_final_del_caso== "POSITIVO", part = "body", bg = "red") 
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=3.2 , fig.width=8}
viruela_curva <- viruela %>% 
  filter(clasificacion_final_del_caso!="NEGATIVO")
plot(incidence(as.Date(viruela_curva$fis), groups = viruela_curva$clasificacion_final_del_caso, first_date = "2022-07-10"), color = "red")+
  coord_cartesian(ylim = c(0,4))+ labs(title = "Curva epidemica casos viruela simica", x = "Fecha inicio de sintomas", y = "Casos")+ scale_x_date(date_breaks = "7 day", date_labels = "%d %b")+
  theme(legend.position = "bottom", axis.text.x = element_text(angle = 45))
```

\newpage

***Jorge Mario Estrada-Alvarez MSc. Epi***

Coordiandor Epidemiologia y Gestion de Conocimiento

***Maryluz Hincapie-Acuña MSc. Epi***

Epidemiologa

***Juan Jose Ramirez-Ospina MSc. Ger***

Epidemiologo

***Angela Monsalve Esp. Epi***

Epidemiologa

***Viviana Trujillo***

Enfermera - SIVIGILA

**Alcaldia de Pereira**

**Secretaria de Salud Publica y Seguridad Social**
